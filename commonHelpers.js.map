{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst form = document.querySelector(\".form\");\nconst input = document.querySelector(\".inputsrc\");\nconst loader = document.querySelector(\".loader\");\nconst gallery = document.querySelector(\".gallery\");\nconst loadbtn = document.querySelector(\".loadbtn\");\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250\n});\n\nlet page = 1;\nlet perPage = 40;\nlet searchParams;\nlet userInput;\nlet response;\nlet cardHeight;\n\nloadbtn.addEventListener(\"click\", loadMoreBtn);\n\nform.addEventListener(\"submit\", async event => {\n  event.preventDefault();\n  gallery.innerHTML = \"\";\n  page = 1;\n  userInput = input.value;\n  loadbtn.classList.add(\"hide\");\n  await postGallery();\n})\n\nasync function loadMoreBtn() {\n  page += 1;\n\n  await postGallery();\n  loadbtn.classList.remove(\"hide\");\n\n  const totalPages = Math.ceil(response.data.totalHits / perPage);\n  if (page >= totalPages) {\n    iziToast.show({\n      message: `We're sorry, but you've reached the end of search results.`,\n      position: 'topRight',\n    });\n    loadbtn.classList.add(\"hide\");\n    return;\n  }\n}\n\nasync function postGallery() {\n  searchParams = {\n    params: {\n      key: '41766309-9b727aff341ca6e5a641aa2fb',\n      q: userInput,\n      orientation: 'horizontal',\n      per_page: perPage,\n      page: page,\n      image_type: 'photo',\n      safesearch: true,\n      order: 'likes',\n    },\n  }; \n  \n  try {\n    loader.classList.remove('hide');\n    response = await axios.get(\n    'https://pixabay.com/api/',\n    searchParams);\n    \n    const images = response.data;\n\n    loader.classList.add('hide');\n\n      if (response.data.totalHits > 0) {\n        const imglist = images.hits.reduce((html, hit) => {\n          return (\n            html +\n            `<li>\n          <a href=\"${hit.largeImageURL}\">\n            <img src=\"${hit.webformatURL}\" alt=\"${hit.tags}\" class=\"gallery-image\">\n          </a>\n          <div class=\"info\">\n            <div class=\"field\">\n              <span class=\"label\">Likes</span>\n              <span class=\"value\">${hit.likes}</span>\n            </div>\n            <div class=\"field\">\n              <span class=\"label\">Views</span>\n              <span class=\"value\">${hit.views}</span>\n            </div>\n            <div class=\"field\">\n              <span class=\"label\">Comments</span>\n              <span class=\"value\">${hit.comments}</span>\n            </div>\n            <div class=\"field\">\n              <span class=\"label\">Downloads</span>\n              <span class=\"value\">${hit.downloads}</span>\n            </div>\n          </div>\n          </li>`\n          )\n        }, '')\n        gallery.insertAdjacentHTML('beforeend', imglist);\n\n        const imgCard = document.querySelector(\".gallery-image\");\n        cardHeight = imgCard.getBoundingClientRect().height;\n\n        window.scrollBy({\n          top: 2 * cardHeight,\n          behavior: 'smooth'\n        });\n\n        lightbox.refresh();\n        \n      } else {\n        iziToast.error({\n          message: 'Sorry, there are no images matching your search query. Please try again!',\n          position: 'topRight'\n        });\n      }\n      updateButtonVisibility();\n\n  }\n    catch (error) {\n        console.log(error);\n    } finally {\n    form.reset();\n    }\n}\n\nfunction updateButtonVisibility() {\n  if (gallery.innerHTML.trim() === \"\") {\n    loadbtn.classList.add(\"hide\");\n  } else {\n    loadbtn.classList.remove(\"hide\");\n  }\n}"],"names":["form","input","loader","gallery","loadbtn","lightbox","SimpleLightbox","page","perPage","searchParams","userInput","response","cardHeight","loadMoreBtn","event","postGallery","totalPages","iziToast","axios","images","imglist","html","hit","updateButtonVisibility","error"],"mappings":"owBAQA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAQ,SAAS,cAAc,WAAW,EAC1CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAU,SAAS,cAAc,UAAU,EAE3CC,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAED,IAAIC,EAAO,EACPC,EAAU,GACVC,EACAC,EACAC,EACAC,EAEJR,EAAQ,iBAAiB,QAASS,CAAW,EAE7Cb,EAAK,iBAAiB,SAAU,MAAMc,GAAS,CAC7CA,EAAM,eAAc,EACpBX,EAAQ,UAAY,GACpBI,EAAO,EACPG,EAAYT,EAAM,MAClBG,EAAQ,UAAU,IAAI,MAAM,EAC5B,MAAMW,EAAW,CACnB,CAAC,EAED,eAAeF,GAAc,CAC3BN,GAAQ,EAER,MAAMQ,EAAW,EACjBX,EAAQ,UAAU,OAAO,MAAM,EAE/B,MAAMY,EAAa,KAAK,KAAKL,EAAS,KAAK,UAAYH,CAAO,EAC9D,GAAID,GAAQS,EAAY,CACtBC,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,UAChB,CAAK,EACDb,EAAQ,UAAU,IAAI,MAAM,EAC5B,MACD,CACH,CAEA,eAAeW,GAAc,CAC3BN,EAAe,CACb,OAAQ,CACN,IAAK,qCACL,EAAGC,EACH,YAAa,aACb,SAAUF,EACV,KAAMD,EACN,WAAY,QACZ,WAAY,GACZ,MAAO,OACR,CACL,EAEE,GAAI,CACFL,EAAO,UAAU,OAAO,MAAM,EAC9BS,EAAW,MAAMO,EAAM,IACvB,2BACAT,CAAY,EAEZ,MAAMU,EAASR,EAAS,KAItB,GAFFT,EAAO,UAAU,IAAI,MAAM,EAErBS,EAAS,KAAK,UAAY,EAAG,CAC/B,MAAMS,EAAUD,EAAO,KAAK,OAAO,CAACE,EAAMC,IAEtCD,EACA;AAAA,qBACSC,EAAI;AAAA,wBACDA,EAAI,sBAAsBA,EAAI;AAAA;AAAA;AAAA;AAAA;AAAA,oCAKlBA,EAAI;AAAA;AAAA;AAAA;AAAA,oCAIJA,EAAI;AAAA;AAAA;AAAA;AAAA,oCAIJA,EAAI;AAAA;AAAA;AAAA;AAAA,oCAIJA,EAAI;AAAA;AAAA;AAAA,iBAK7B,EAAE,EACLnB,EAAQ,mBAAmB,YAAaiB,CAAO,EAG/CR,EADgB,SAAS,cAAc,gBAAgB,EAClC,sBAAuB,EAAC,OAE7C,OAAO,SAAS,CACd,IAAK,EAAIA,EACT,SAAU,QACpB,CAAS,EAEDP,EAAS,QAAO,CAExB,MACQY,EAAS,MAAM,CACb,QAAS,2EACT,SAAU,UACpB,CAAS,EAEHM,GAEH,OACQC,EAAP,CACI,QAAQ,IAAIA,CAAK,CACzB,QAAc,CACVxB,EAAK,MAAK,CACT,CACL,CAEA,SAASuB,GAAyB,CAC5BpB,EAAQ,UAAU,KAAI,IAAO,GAC/BC,EAAQ,UAAU,IAAI,MAAM,EAE5BA,EAAQ,UAAU,OAAO,MAAM,CAEnC"}